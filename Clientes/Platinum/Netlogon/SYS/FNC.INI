'Variaveis do Logon
'autoria Leonardo Vivas
'Versão 2.0
'criação 03/06/2009
'modificação 03/03/2012
' -----------------------------------------------------------------'

Function RemoveDrivesRede
Set colDrives = oNet.EnumNetworkDrives
For i = 0 to colDrives.Count-1 Step 2
oNet.RemoveNetworkDrive colDrives.Item(i), true, true
Next
End Function

function CriaPasta(pasta)
If Not oFso.FolderExists(pasta) Then oFso.CreateFolder(pasta)
End Function

Function TelaLogon
If Not oFso.FileExists(HTA & "\Logon.hta") Then oFSO.CopyFile DIR & "\HTA\Logon.hta" , HTA & "\Logon.hta", OverwriteExisting
oShell.Run (HTA&"\logon.hta"),1 ,False
End Function

Function BGINFO
'oFSO.DeleteFile USERPROFILE & "\AppData\Local\Temp\bginfo.bmp"
'oFSO.DeleteFile USERPROFILE & "\Configurações locais\Temp\bginfo.bmp"
If Not oFso.FileExists(PROGS & "\bginfo.exe") Then oFSO.CopyFile DIR & "\PROGS\bginfo.exe" , PROGS & "\bginfo.exe", OverwriteExisting
If Not oFso.FileExists(PROGS & "\" & DOMI & ".bgi") Then oFSO.CopyFile DIR & "\PROGS\bginfo.bgi" , PROGS & "\" & DOMI & ".bgi", OverwriteExisting
Wscript.Sleep 2500
oShell.Run (BG & " " & PROGS & "\" & DOMI & ".bgi /timer:0 /nolicprompt /silent"),0 ,False
End Function

Function ApagaArquivos2M(pasta)
Set objFolder = oFSO.GetFolder(pasta)
Set colFiles = objFolder.Files
For Each objFile in colFiles
if objFile.Size >= 2097152 Then
oFSO.DeleteFile(pasta & "\" & objFile.Name)
end if
Next
End Function

Function ApagaArquivos5M(pasta)
Set objFolder = oFSO.GetFolder(pasta)
Set colFiles = objFolder.Files
For Each objFile in colFiles
if objFile.Size >= 5242880 Then
oFSO.DeleteFile(pasta & "\" & objFile.Name)
end if
Next
End Function